plugins {
  id "java-library"
  id "com.github.johnrengelman.shadow" version "8.1.1"
}

repositories {
  mavenCentral()
}

sourceCompatibility = JavaVersion.VERSION_17
targetCompatibility = JavaVersion.VERSION_17

def mainClassName = "com.mageddo.coffeemaker.checkout.Main"

jar {
  manifest {
    attributes(
      "Main-Class": mainClassName
    )
  }
}

shadowJar {
  mergeServiceFiles()
  append 'META-INF/spring.handlers'
  append 'META-INF/spring.schemas'
  append 'META-INF/spring.tooling'
  transform(com.github.jengelman.gradle.plugins.shadow.transformers.PropertiesFileTransformer) {
    paths = ['META-INF/spring.factories' ]
    mergeStrategy = "append"
  }
}

dependencies {
  compileOnly 'org.projectlombok:lombok:1.18.28'
  annotationProcessor 'org.projectlombok:lombok:1.18.28'

  implementation group: 'org.apache.commons', name: 'commons-lang3', version: '3.13.0'
  implementation group: 'org.springframework.boot', name: 'spring-boot-starter-web', version: '3.1.2'

  implementation('io.opentelemetry:opentelemetry-api:1.31.0')
  implementation('io.opentelemetry:opentelemetry-extension-incubator:1.31.0-alpha')
  implementation('io.opentelemetry.instrumentation:opentelemetry-instrumentation-annotations:1.30.0')

  implementation group: 'io.opentelemetry', name: 'opentelemetry-sdk', version: '1.31.0'
  implementation 'io.opentelemetry:opentelemetry-exporter-otlp:1.31.0'
  implementation 'io.opentelemetry:opentelemetry-exporter-sender-jdk:1.31.0-alpha'
  implementation("io.opentelemetry:opentelemetry-sdk-metrics:1.31.0")
  implementation("io.opentelemetry:opentelemetry-semconv:1.30.1-alpha");



  testCompileOnly 'org.projectlombok:lombok:1.18.28'
  testAnnotationProcessor 'org.projectlombok:lombok:1.18.28'

}
