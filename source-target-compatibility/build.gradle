plugins {
  id "java"
  id "com.github.johnrengelman.shadow" version "7.1.2"
}

repositories {
  mavenCentral()
}

configure([tasks.compileJava]) {
  sourceCompatibility = 17
  options.release = 8

  javaCompiler = javaToolchains.compilerFor {
    languageVersion = JavaLanguageVersion.of(17)
  }
}

dependencies {
  annotationProcessor 'com.github.bsideup.jabel:jabel-javac-plugin:0.4.2'
  compileOnly 'com.github.bsideup.jabel:jabel-javac-plugin:0.4.2'
}

def mainClassName = "com.mageddo.app.App"

jar {
  manifest {
    attributes(
      "Main-Class": mainClassName
    )
  }
}

shadowJar {
  mergeServiceFiles()
}
